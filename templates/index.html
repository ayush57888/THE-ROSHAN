<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KO FF GLOBAL</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* ===== Password Overlay ===== */
        #password-overlay {
            position: fixed;
            inset: 0;
            background: #0f0f1b;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        #password-box {
            background: #1c1c2e;
            padding: 30px 40px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
            text-align: center;
        }
        #password-box h2 {
            color: #ff2a2a;
            margin-bottom: 20px;
        }
        #password-input {
            padding: 10px;
            width: 220px;
            border: none;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 15px;
        }
        #enter-btn {
            background: #ff2a2a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }
        #enter-btn:hover { background: #ff4444; }
        #error-msg { color: #ff5555; margin-top: 10px; }
        #main-content { display: none; }

        /* ===== Social Links Styling ===== */
        .social-links {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
        }
        .social-links img {
            width: 40px;
            height: 40px;
            cursor: pointer;
            filter: brightness(0) invert(1);
            transition: transform 0.3s, filter 0.3s;
        }
        .social-links img:hover {
            transform: scale(1.15);
            filter: drop-shadow(0 0 8px #ff2a2a);
        }
    </style>
</head>
<body>
    <!-- ðŸ” Password Lock Screen -->
    <div id="password-overlay">
        <div id="password-box">
            <h2>Enter Access Password</h2>
            <input type="password" id="password-input" placeholder="Enter password">
            <br>
            <button id="enter-btn">Enter</button>
            <div id="error-msg"></div>
        </div>
    </div>

    <!-- ðŸŒ Main Website -->
    <div id="main-content" class="container">
        <header>
            <h1>KO FF GLOBAL</h1>

            <!-- ðŸŒ Social Media Links -->
            <div class="social-links">
                <a href="https://discord.gg/tKbGDueAJD" target="_blank">
                    <img src="{{ url_for('static', filename='icons/discord.png') }}" alt="Discord">
                </a>
                <a href="https://www.youtube.com/@KOFFGLOBAL" target="_blank">
                    <img src="{{ url_for('static', filename='icons/youtube.png') }}" alt="YouTube">
                </a>
            </div>
        </header>

        <div class="input-section">
            <div class="team-code-section">
                <label for="team-code">Team Code:</label>
                <input type="text" id="team-code" placeholder="Enter team code">
            </div>

            <div class="uid-section">
                <label for="uid1">UID 1:</label>
                <input type="text" class="uid-input" id="uid1" placeholder="Enter UID 1">
                
                <label for="uid2">UID 2:</label>
                <input type="text" class="uid-input" id="uid2" placeholder="Enter UID 2 (optional)">
                
                <label for="uid3">UID 3:</label>
                <input type="text" class="uid-input" id="uid3" placeholder="Enter UID 3 (optional)">
                
                <label for="uid4">UID 4:</label>
                <input type="text" class="uid-input" id="uid4" placeholder="Enter UID 4 (optional)">
            </div>
        </div>

        <div class="result-display">
            <h3>Result:</h3>
            <pre id="result-box" class="api-url-box">Ready. Fill in the details and send an emote.</pre>
        </div>

        <div class="emote-list">
            {% for emote in emotes %}
            <div class="emote-item">
                <img src="{{ url_for('static', filename='images/' + emote.image) }}" alt="{{ emote.name }}">
                <div class="emote-details">
                    <p class="emote-name">{{ emote.name }}</p>
                    <p class="emote-id">ID: {{ emote.id }}</p>
                </div>
                <button class="send-button" data-emote-id="{{ emote.id }}">Send</button>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        // âœ… Change your password here
        const CORRECT_PASSWORD = "4788";

        // Password gate logic
        document.getElementById("enter-btn").addEventListener("click", function() {
            const input = document.getElementById("password-input").value.trim();
            const errorMsg = document.getElementById("error-msg");

            if (input === CORRECT_PASSWORD) {
                document.getElementById("password-overlay").style.display = "none";
                document.getElementById("main-content").style.display = "block";
            } else {
                errorMsg.textContent = "Incorrect password!";
            }
        });

        // ===== Send Button Logic =====
        document.addEventListener('DOMContentLoaded', function() {
            const emoteListContainer = document.querySelector('.emote-list');
            const resultBox = document.getElementById('result-box');

            emoteListContainer.addEventListener('click', function(event) {
                if (event.target.classList.contains('send-button')) {
                    const sendButton = event.target;
                    const teamCode = document.getElementById('team-code').value.trim();
                    const emoteId = sendButton.getAttribute('data-emote-id');
                    const uidInputs = document.querySelectorAll('.uid-input');
                    const uids = [];
                    uidInputs.forEach(input => {
                        const uidValue = input.value.trim();
                        if (uidValue) uids.push(uidValue);
                    });

                    if (!teamCode) {
                        resultBox.textContent = 'Error: Please enter a team code.';
                        return;
                    }
                    if (uids.length === 0) {
                        resultBox.textContent = 'Error: Please enter at least one UID.';
                        return;
                    }

                    resultBox.textContent = 'Sending request...';
                    sendButton.disabled = true;

                    const payload = { team_code: teamCode, emote_id: emoteId, uids: uids };

                    fetch('/send_emote', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    })
                    .then(response => response.json())
                    .then(data => {
                        resultBox.textContent = JSON.stringify(data, null, 2);
                    })
                    .catch(error => {
                        console.error('Fetch Error:', error);
                        resultBox.textContent = 'Error communicating with the server.';
                    })
                    .finally(() => {
                        sendButton.disabled = false;
                    });
                }
            });
        });
    </script>
</body>
</html>
